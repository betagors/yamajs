# @betagors/yama-cli

Global CLI tool for Yama - API framework toolkit.

## Installation

```bash
npm install -g @betagors/yama-cli
```

## Commands

### Setup & Initialization

#### `yama init`

Initialize a new Yama project. Creates `yama.yaml`, `src/handlers/` directory, and updates `package.json` with scripts.

```bash
yama init
yama init --name my-api --version 1.0.0
```

#### `yama setup`

Setup Yama in an existing project. Adds scripts to `package.json` and checks for dependencies.

```bash
yama setup
yama setup --skip-scripts
```

### Development

#### `yama dev`

Start development server with watch mode.

```bash
yama dev
yama dev --port 3000
yama dev --no-watch
yama dev --config custom.yaml
```

### Generation

#### `yama generate`

Generate SDK and TypeScript types from `yama.yaml`.

```bash
yama generate
yama generate --watch
yama generate --output src/lib/api.ts
yama generate --types-only
yama generate --sdk-only
yama generate --framework nextjs
```

#### `yama types`

Generate TypeScript types only.

```bash
yama types
yama types --output src/types.ts
```

#### `yama sdk`

Generate SDK only.

```bash
yama sdk
yama sdk --output src/lib/api.ts
yama sdk --framework react
```

### Validation & Inspection

#### `yama validate`

Validate `yama.yaml` configuration.

```bash
yama validate
yama validate --strict
yama validate --config custom.yaml
```

#### `yama config`

Show current configuration.

```bash
yama config
```

#### `yama endpoints`

List all endpoints defined in `yama.yaml`.

```bash
yama endpoints
```

#### `yama schemas`

List all schemas defined in `yama.yaml`.

```bash
yama schemas
```

## Features

- **Smart Project Detection**: Automatically detects Next.js, React, Vite, or Node.js projects
- **Watch Mode**: Auto-regenerate SDK/types when `yama.yaml` changes
- **Framework Helpers**: Generates framework-specific hooks and helpers (Next.js, React)
- **Zero Configuration**: Works out of the box with smart defaults

## Workflow

### First-time Setup

```bash
# 1. Install globally (one time)
npm install -g @betagors/yama-cli

# 2. Create new project
mkdir my-api
cd my-api
npm init -y

# 3. Initialize Yama
yama init

# 4. Install runtime
npm install @betagors/yama-node

# 5. Start developing
yama dev
```

### Daily Development

```bash
# Edit yama.yaml
vim yama.yaml

# SDK auto-regenerates (watch mode)
# Server auto-restarts
# Everything stays in sync
```

### Generate SDK for Frontend

```bash
# In backend project
yama generate --output ../frontend/src/lib/api.ts

# Or with framework helpers
yama generate --framework nextjs
```

## Project Structure

After running `yama init`, your project will look like:

```
my-api/
├── yama.yaml          # Yama configuration
├── package.json       # Has @betagors/yama-* dependencies
├── src/
│   ├── handlers/      # Your handlers
│   └── generated/     # Auto-generated by Yama
│       ├── types.ts
│       └── sdk.ts
└── node_modules/
    └── @betagors/     # Published packages
```

## Framework Support

### Next.js

```bash
yama generate --framework nextjs
```

Generates:
- `lib/generated/types.ts`
- `lib/generated/sdk.ts`
- `lib/hooks/useApi.ts` (React Query hooks)

### React/Vite

```bash
yama generate --framework react
```

Generates:
- `src/lib/generated/types.ts`
- `src/lib/generated/sdk.ts`
- `src/hooks/useApi.ts` (React hooks)

### Node.js

```bash
yama generate
```

Generates:
- `lib/generated/types.ts`
- `lib/generated/sdk.ts`

## License

MIT

